
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>68. Numerical solution of ordinary differential equations: One step methods &#8212; PDE tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'TMA4125/ErrorAnalysisNuMeODE';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="70. Introduction to TMA4125" href="Introduction.html" />
    <link rel="prev" title="67. A simple epidemic model for Covid 19 and its numerical solution" href="SimpleCovidModel.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Jun 03, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="PDE tutorial - Home"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="PDE tutorial - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    PDE Tutorial
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">The Finite Difference Method</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notes/pde.html">1. Partial Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/fda.html">2. Finite-Difference Approximations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/elliptic.html">3. Elliptic Partial Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/octave.html">4. octave</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pystencils.html">5. pystencils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jax/jax.html">6. Introduction to JAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jax/finitediffx.html">7. finitediffx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jax/kernex.html">8. kernex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../py-pde.html">9. <code class="docutils literal notranslate"><span class="pre">py-pde</span></code> tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../findiff.html">10. <code class="docutils literal notranslate"><span class="pre">findiff</span></code> tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../symbolic-findiff.html">11. Symbolic <code class="docutils literal notranslate"><span class="pre">findiff</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../solve-findiff.html">12. Solve with <code class="docutils literal notranslate"><span class="pre">findiff</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../advectionper.html">13. <code class="docutils literal notranslate"><span class="pre">AdvectionPer.m</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../diffusioncrancknic.html">14. <code class="docutils literal notranslate"><span class="pre">DiffusionCrankNic.m</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../advection-pystencils.html">15. Advection pystencils example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../petsc.html">16. 1D heat diffusion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Finite Volume Method</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../clawpack.html">1D advection equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Mimetic Finite Difference Method</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mimetic/mole.html">mole</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Simulating Fluid Flows Using Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture1.html">17. Introduction to Computational Fluid Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture2.html">18. Finite Differences - First Derivative</a></li>

<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture3.html">20. Finite differences in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture4.html">21. Second derivative - 1D heat conduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture5.html">22. Introduction to Finite Volume Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture6.html">23. CFD Relevant Python Statements | While | For</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture7.html">24. Conduction Visualization Python Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture8.html">25. Generalized FVM Formulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fluids/lecture10.html">26. 0</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computers, Waves, Simulations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../waves/W2_P1.html">27. First Derivative</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W2_P2.html">28. Second Derivative</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W2_P3.html">29. High-Order Taylor Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W3_P1_Gaussian.html">30. Acoustic Waves 1D I</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W3_P2_Gaussian_analytical.html">31. Acoustic Waves 1D II</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W4_ac1d_optimal_operators.html">32. Acoustic Waves 1D - Optimal Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W4_fd_ac2d_heterogeneous_solutions.html">33. Acoustic Waves 2D - Heterogeneous case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W4_fd_ac2d_homogeneous.html">34. Acoustic Waves 2D - Homogeneous case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W4_fd_advection_1d.html">35. Advection equation 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W4_fd_elastic1d_staggered_solution.html">36. Grid-Staggering Elastic 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W5_ps_cheby_derivative_solution.html">37. The Pseudo-Spectral Method - Numerical Derivatives based on a Derivative Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W5_ps_cheby_elastic_1d_solution.html">38. The Pseudo-Spectral Method - Elastic Wave Equation 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W5_ps_fourier_acoustic_1d.html">39. The Pseudo-Spectral Method - Acoustic Waves in 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W5_ps_fourier_acoustic_2d.html">40. The Pseudo-Spectral Method - Acoustic Waves in 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W6_fe_static_elasticity.html">41. The Finite Element Method - Static Elasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W7_fe_elastic_1d_solution.html">42. The Finite Element Method - Elastic Wave Equation 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W8_se_Lagrange_interpolation_simple.html">43. The Spectral Element Method - Interpolation with Lagrange Polynomials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W8_se_numerical_integration_GLL.html">44. The Spectral Element Method - Numerical Integration - The Gauss-Lobatto-Legendre approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W9_se_hetero_1d_solution.html">45. Spectral Element Method - Elastic Wave Equation 1D, Heterogeneous case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waves/W9_se_homo_1d_solution.html">46. Spectral Element Method - Elastic Wave Equation 1D - Homogeneous Case</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Differential equations and Fourier analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="fourier_series_supplemental_material.html">47. Fourier series: supplemental material</a></li>
<li class="toctree-l1"><a class="reference internal" href="LagrangeInterpolation.html">48. Polynomial interpolation: Lagrange interpolation</a></li>


<li class="toctree-l1"><a class="reference internal" href="RungeKuttaNuMeODE.html">51. Numerical solution of ordinary differential equations: High order Runge-Kutta methods</a></li>

<li class="toctree-l1"><a class="reference internal" href="TwoPointBoundaryProblems.html">53. Finite difference methods for two-point value problems</a></li>



<li class="toctree-l1"><a class="reference internal" href="CompositeQuadrature.html">57. Numerical integration: Part II</a></li>



<li class="toctree-l1"><a class="reference internal" href="GaussQuadrature.html">61. Numerical integration: Part IV</a></li>


<li class="toctree-l1"><a class="reference internal" href="lecture_01_introduction.html">64. Introduction to TMA4125</a></li>


<li class="toctree-l1"><a class="reference internal" href="SimpleCovidModel.html">67. A simple epidemic model for Covid 19 and its numerical solution</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">68. Numerical solution of ordinary differential equations: One step methods</a></li>

<li class="toctree-l1"><a class="reference internal" href="Introduction.html">70. Introduction to TMA4125</a></li>


<li class="toctree-l1"><a class="reference internal" href="NewtonInterpolation.html">73. Polynomial interpolation: Newton interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="SimpleQuadrature.html">74. Numerical integration</a></li>



<li class="toctree-l1"><a class="reference internal" href="ErrorTheoryInterpolation.html">78. Polynomial interpolation: Error theory</a></li>

<li class="toctree-l1"><a class="reference internal" href="IntroductionNuMeODE.html">80. Numerical solution of ordinary differential equations: Euler’s and Heun’s method</a></li>





<li class="toctree-l1"><a class="reference internal" href="NumericalMethodsHeatEquation.html">86. Numerical methods for the heat equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Finite Difference Computing with PDEs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../hplgit/vibration.html">87. Lecture 3</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">End Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cpp-review-dune/python-pde" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cpp-review-dune/python-pde/edit/main/pde-book/TMA4125/ErrorAnalysisNuMeODE.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cpp-review-dune/python-pde/issues/new?title=Issue%20on%20page%20%2FTMA4125/ErrorAnalysisNuMeODE.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/TMA4125/ErrorAnalysisNuMeODE.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Numerical solution of ordinary differential equations: One step methods</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">68. Numerical solution of ordinary differential equations: One step methods</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#one-step-methods">69. One Step Methods</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-1-one-step-methods">69.1. Definition 1: One step methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-increment-functions-for-euler-and-heun">69.2. Example 1: Increment functions for Euler and Heun</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#local-and-global-truncation-error-of-osm">69.3. Local and global truncation error of OSM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-2-local-truncation-error">69.4. Definition 2: Local truncation error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">69.5. Example 2:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-3-global-truncation-error">69.6. Definition 3: Global truncation error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-convergence-order-for-euler-and-heun">69.7. Exercise 1: Convergence order for Euler and Heun</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-general-convergence-result-for-one-step-methods">69.8. A general convergence result for one step methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theorem-1-convergence-of-one-step-methods">69.9. Theorem 1: Convergence of one-step methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convergence-properties-of-heun-s-method">69.10. Convergence properties of Heun’s method</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <!-- KODE = "ja", "nei", default "ja" -->
<!-- dom:TITLE: Numerical solution of ordinary differential equations: One step methods -->
<section class="tex2jax_ignore mathjax_ignore" id="numerical-solution-of-ordinary-differential-equations-one-step-methods">
<h1><span class="section-number">68. </span>Numerical solution of ordinary differential equations: One step methods<a class="headerlink" href="#numerical-solution-of-ordinary-differential-equations-one-step-methods" title="Link to this heading">#</a></h1>
<!-- dom:AUTHOR: André Massing -->
<!-- Author: -->  
<p><strong>Anne Kværnø, André Massing</strong></p>
<p>Date: <strong>March 22, 2021</strong></p>
<p>If you want to have a nicer theme for your jupyter notebook,
download the <a class="reference external" href="https://www.math.ntnu.no/emner/TMA4125/2020v/part_II/notebooks/tma4125.css">cascade stylesheet file tma4125.css</a>
and execute the next cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">solve</span>


<span class="k">def</span> <span class="nf">css_styling</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;tma4125.css&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">styles</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">styles</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Do nothing</span>


<span class="c1"># Comment out next line and execute this cell to restore the default notebook style</span>
<span class="n">css_styling</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><link href='http://fonts.googleapis.com/css?family=Alegreya+Sans:100,300,400,500,700,800,900,100italic,300italic,400italic,500italic,700italic,800italic,900italic' rel='stylesheet' type='text/css'> <link href='http://fonts.googleapis.com/css?family=Arvo:400,700,400italic' rel='stylesheet' type='text/css'> <link href="https://fonts.googleapis.com/css?family=News+Cycle" rel="stylesheet"> <link href='http://fonts.googleapis.com/css?family=Nixie+One' rel='stylesheet' type='text/css'> <link href='http://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'> <link href='http://fonts.googleapis.com/css?family=Shadows+Into+Light' rel='stylesheet' type='text/css'> <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet"> <style> @font-face {
    /*font-family: "Computer Modern";*/
    /*src: url('http://mirrors.ctan.org/fonts/cm-unicode/fonts/otf/cmunss.otf');*/
    font-family: 'News Cycle', sans-serif;
}


/* main background */


/*#notebook_panel { 
        background: #C9D4E2;
    }*/

div.cell {
    /*max-width:600px;*/
    /*margin-left:16% !important;*/
    /*margin-right:auto;*/
}

div.text_cell {
    max-width: 120ex;
    /* instead of 100%, */
}

div.text_cell_render {
    font-family: 'Alegreya Sans', Computer Modern, "Helvetica Neue", Arial, Helvetica, Geneva,   sans-serif;
    line-height: 135%;
    /*font-size:    45pt;*/
    font-size: 130%;
    /*width:600px;*/
    /*margin-left:auto;*/
    /*margin-right:auto;*/
}

.CodeMirror {
    /*font-family: 'Source Code Pro', monospace;*/
    /*font-style: italic;*/
    /*font-weight: bold;*/
    /*font-size: 120%;*/
}


/*.prompt{
        display: None;
    }*/

.text_cell_render h1 {
    font-family: 'Nixie One', serifV;
    font-style: regular;
    font-weight: 400;
    font-size: 45pt;
    line-height: 100%;
        color: #497BB9;    
    /*color: #5889C5;*/
    /*color: rgb(0, 51, 102);*/
    /*font-weight: 200;*/
    /*font-size: 50pt;*/
    margin-bottom: 0.5em;
    margin-top: 0.5em;
    display: block;
}

.text_cell_render h2 {
    font-family: 'Nixie One', serif;
    font-weight: 400;
    font-size: 30pt;
    line-height: 100%;
    /*color: rgb(0,51,102);*/
    color: #497BB9;    
    margin-bottom: 0.1em;
    margin-top: 0.3em;
    display: block;
}	

.text_cell_render h3 {
    font-family: 'Nixie One', serif;
    margin-top:16px;
    font-size: 22pt;
    font-weight: 600;
    margin-bottom: 3px;
    font-style: regular;
    color: rgb(102,102,0);
}

.text_cell_render h4 {    /*Use this for captions*/
    font-family: 'Nixie One', serif;
    font-size: 14pt;
/*    text-align: center;*/
    margin-top: 0em;
    margin-bottom: 2em;
    font-style: regular;
}

.text_cell_render h5 {  /*Use this for small titles*/
    font-family: 'Nixie One', sans-serif;
    font-weight: 400;
    font-size: 16pt;
    color: rgb(163,0,0);
    /*color: #5889C5;*/
    /*margin-bottom: .5em;
    margin-top: 0.5em;*/
    font-style: italic;
    margin-bottom: .1em;
    margin-top: 0.8em;
    display: block;
}

.warning {
    color: rgb( 240, 20, 20)
}

</style> 
<script>
 MathJax.Hub.Config( {
    TeX: {
        Macros: {
            NN: "{\\bf N}",
            RR: "{\\mathbb{R}}",
            mcO: "{\\mathcal{O}}"
        },
        equationNumbers: { autoNumber: "AMS" },
        extensions: ["AMSmath.js", "begingroup.js"] 
    },
    tex2jax: {
        inlineMath: [ ['$', '$'], ["\\(", "\\)"]], displayMath: [ ['$$', '$$'], ["\\[", "\\]"]]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {
            '.MathJax_Display': {
                "margin": 4
            }
        }
    }
}
);
</script>
</div></div>
</div>
<p>As always, we start by importing the necessary modules:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline


<span class="c1"># Use a funny plotting style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">()</span>
<span class="n">newparams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">),</span>
    <span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;lines.markersize&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s2">&quot;lines.linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">newparams</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="one-step-methods">
<h1><span class="section-number">69. </span>One Step Methods<a class="headerlink" href="#one-step-methods" title="Link to this heading">#</a></h1>
<p>In the last lecture, we introduced the explicit Euler method
and Heun’s method, motivating the following definition.</p>
<section id="definition-1-one-step-methods">
<h2><span class="section-number">69.1. </span>Definition 1: One step methods<a class="headerlink" href="#definition-1-one-step-methods" title="Link to this heading">#</a></h2>
<p>A one step method defines an approximation to the IVP
in the form of a discrete function
<span class="math notranslate nohighlight">\(
{\boldsymbol y}_{\Delta}:
\{
t_0, \ldots, t_N
\} \to \mathbb{R}^n
\)</span>
given by</p>
<!-- Equation labels as ordinary links -->
<div id="ode:eq:osm-def"></div>
<p>\begin{equation}
{\boldsymbol y}<em>{k+1}
:=
{\boldsymbol y}<em>k
+
\tau_k
\Phi(t_k,
{\boldsymbol y}</em>{k},
{\boldsymbol y}</em>{k+1},
\tau_{k})
\label{ode:eq:osm-def} \tag{1}
\end{equation}</p>
<p>for some <strong>increment function</strong></p>
<div class="math notranslate nohighlight">
\[
\Phi: [t_0,T] \times \mathbb{R}^n \times \mathbb{R}^n \times \mathbb{R}^+ \to \mathbb{R}^n.
\]</div>
<p>The OSM is called <strong>explicit</strong> if the increment function <span class="math notranslate nohighlight">\(\Phi\)</span>
does not depend on <span class="math notranslate nohighlight">\({\boldsymbol y}_{k+1}\)</span>, otherwise it is called <strong>implicit</strong>.</p>
</section>
<section id="example-1-increment-functions-for-euler-and-heun">
<h2><span class="section-number">69.2. </span>Example 1: Increment functions for Euler and Heun<a class="headerlink" href="#example-1-increment-functions-for-euler-and-heun" title="Link to this heading">#</a></h2>
<div id="ode:exa:increment_function"></div>
The increment functions for Euler's and Heun's method are
defined by respectively
<div class="math notranslate nohighlight">
\[
\Phi(t_k,
y_{k},
y_{k+1},
\tau_{k})
=
f(t_k, y_k),
\qquad
\Phi(t_k,
y_{k},
y_{k+1},
\tau_{k})
=
\tfrac{1}{2}
\left(
f(t_{k}, y_k)
+
f\bigl(t_{k+1}, y_{k}+\tau_k f(t_k, y_k)
\bigr)
\right).
\]</div>
</section>
<section id="local-and-global-truncation-error-of-osm">
<h2><span class="section-number">69.3. </span>Local and global truncation error of OSM<a class="headerlink" href="#local-and-global-truncation-error-of-osm" title="Link to this heading">#</a></h2>
</section>
<section id="definition-2-local-truncation-error">
<h2><span class="section-number">69.4. </span>Definition 2: Local truncation error<a class="headerlink" href="#definition-2-local-truncation-error" title="Link to this heading">#</a></h2>
<div id="ode:def:consist_err"></div>
<p>The <strong>local truncation error</strong> <span class="math notranslate nohighlight">\(\eta(t, \tau)\)</span> is defined by</p>
<!-- Equation labels as ordinary links -->
<div id="ode:eq:consist_err"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\eta(t, \tau) = y(t) + \tau \Phi(t, y(t), y(t+\tau), \tau) - y(t+\tau).
\label{ode:eq:consist_err} \tag{2}
\end{equation}
\]</div>
<p><span class="math notranslate nohighlight">\(\eta(t, \tau)\)</span> is often also called the <strong>local discretization</strong> or <strong>consistency error</strong>.</p>
<p>A one step method is called <strong>consistent of order <span class="math notranslate nohighlight">\(p\in \mathbb{N}\)</span></strong> if
there is a constant <span class="math notranslate nohighlight">\(C &gt; 0\)</span> such that</p>
<!-- Equation labels as ordinary links -->
<div id="_auto1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
|\eta(t, \tau) | \leqslant C \tau^{p+1} \quad \text{for } \tau \to 0.
\label{_auto1} \tag{3}
\end{equation}
\]</div>
<p>A short-hand notation for this is to write
<span class="math notranslate nohighlight">\(
\eta(t, \tau) = \mathcal{O}(\tau^{p+1})\)</span> for <span class="math notranslate nohighlight">\(\tau \to 0.
\)</span></p>
</section>
<section id="example-2">
<h2><span class="section-number">69.5. </span>Example 2:<a class="headerlink" href="#example-2" title="Link to this heading">#</a></h2>
<p>Euler’s method has consistency order <span class="math notranslate nohighlight">\(p=1\)</span>.</p>
</section>
<section id="definition-3-global-truncation-error">
<h2><span class="section-number">69.6. </span>Definition 3: Global truncation error<a class="headerlink" href="#definition-3-global-truncation-error" title="Link to this heading">#</a></h2>
<p>For a numerical solution
<span class="math notranslate nohighlight">\(
y_{\Delta}:
\{
t_0, \ldots, t_N
\} \to \mathbb{R}
\)</span>
the <strong>global truncation error</strong>  is defined by</p>
<!-- Equation labels as ordinary links -->
<div id="ode:eq:global_err"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
e_k(t_k, \tau_k) = y(t_k) - y_k
\quad \text{for } k=0,\ldots,N.
\label{ode:eq:global_err} \tag{4}
\end{equation}
\]</div>
<p>A one step method is called <strong>convergent with order <span class="math notranslate nohighlight">\(p\in\mathbb{N}\)</span></strong> if</p>
<!-- Equation labels as ordinary links -->
<div id="ode:eq:global_err_conv"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\max_{k \in \{0,1,\ldots,N_t\}}
|e_k(t_k,\tau_k)|
= \mathcal{O}(\tau^p)
\label{ode:eq:global_err_conv} \tag{5}
\end{equation}
\]</div>
<p>with <span class="math notranslate nohighlight">\(\tau = \max_k \tau_k\)</span>.</p>
<p><strong>Discussion.</strong>
If a one step method has convergence order equal to <span class="math notranslate nohighlight">\(p\)</span>, the maximum
error
<span class="math notranslate nohighlight">\(e(\tau) = \max_k{|e(t_k, \tau)|}\)</span>
can be thought as a function of the step size <span class="math notranslate nohighlight">\(\tau\)</span> is of the form</p>
<div class="math notranslate nohighlight">
\[
e(\tau) = O(\tau^p) \leqslant C \tau^p.
\]</div>
<p>This implies that if we change the time step size
from <span class="math notranslate nohighlight">\(\tau\)</span> to <span class="math notranslate nohighlight">\(\tfrac{\tau}{2}\)</span>,
we can expect that the
error decreases from <span class="math notranslate nohighlight">\(C \tau^p\)</span>
to <span class="math notranslate nohighlight">\(C (\tfrac{\tau}{2})^p\)</span>, that is, the error
will be reduced by a factor <span class="math notranslate nohighlight">\(2^{-p}\)</span>.</p>
<p>How can we determine the convergence rate by means of numerical
experiments?
Starting from
<span class="math notranslate nohighlight">\(
e(\tau) = O(\tau^p) \leqslant C \tau^p
\)</span>
and taking the logarithm gives</p>
<div class="math notranslate nohighlight">
\[
\log(e(\tau)) \leqslant p \log(\tau) + \log(C).
\]</div>
<p>Thus <span class="math notranslate nohighlight">\(\log(e(\tau))\)</span> is a linear function of <span class="math notranslate nohighlight">\(\log(\tau)\)</span> and the slope
of this linear function corresponds to the order of convergence <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>So if you have an <em>exact solution</em> at your disposal, you can for an
increasing sequence <code class="docutils literal notranslate"><span class="pre">Nmax_list</span></code> defining a descreasing sequence of
<em>maximum</em> time-steps <span class="math notranslate nohighlight">\(\{\tau_0,
\ldots, \tau_M\}\)</span>
and solve your problem numerically and then compute the resulting exact error
<span class="math notranslate nohighlight">\(e(\tau_i)\)</span> and plot it against <span class="math notranslate nohighlight">\(\tau_i\)</span> in a <span class="math notranslate nohighlight">\(\log-\log\)</span> plot to determine
the convergence order.</p>
<p>In addition you can also compute the
<strong>Experimentally Observed Convergence rate</strong>
EOC for <span class="math notranslate nohighlight">\(i=1,\ldots M\)</span> defined by</p>
<div class="math notranslate nohighlight">
\[
\mathrm{EOC}(i) =
\dfrac{
\log(e(\tau_{i})) - \log(e(\tau_{i-1}))
}{
\log(\tau_{i}) - \log(\tau_{i-1})
}
=
\dfrac{
\log(e(\tau_{i})/e(\tau_{i-1}))
}{
\log(\tau_{i}/\tau_{i-1})
}
\]</div>
<p>Ideally, <span class="math notranslate nohighlight">\(\mathrm{EOC}(i)\)</span> is close to <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This is implemented in the following <code class="docutils literal notranslate"><span class="pre">python</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_eoc</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Nmax_list</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="n">y_ex</span><span class="p">):</span>
    <span class="n">errs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">Nmax</span> <span class="ow">in</span> <span class="n">Nmax_list</span><span class="p">:</span>
        <span class="n">ts</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Nmax</span><span class="p">)</span>
        <span class="n">ys_ex</span> <span class="o">=</span> <span class="n">y_ex</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
        <span class="n">errs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ys</span> <span class="o">-</span> <span class="n">ys_ex</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For Nmax = </span><span class="si">{</span><span class="n">Nmax</span><span class="si">:</span><span class="s2">3</span><span class="si">}</span><span class="s2">, max ||y(t_i) - y_i||= </span><span class="si">{</span><span class="n">errs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">errs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">errs</span><span class="p">)</span>
    <span class="n">Nmax_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Nmax_list</span><span class="p">)</span>
    <span class="n">dts</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nmax_list</span>

    <span class="n">eocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">errs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">errs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">dts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">errs</span><span class="p">,</span> <span class="n">eocs</span>
</pre></div>
</div>
</div>
</div>
<!-- --- begin exercise --- -->
</section>
<section id="exercise-1-convergence-order-for-euler-and-heun">
<h2><span class="section-number">69.7. </span>Exercise 1: Convergence order for Euler and Heun<a class="headerlink" href="#exercise-1-convergence-order-for-euler-and-heun" title="Link to this heading">#</a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">compute_eoc</span></code> function and
any of the examples with a known analytical solution from the previous lecture
to determine convergence order for Euler’s and Heun’s method.</p>
<p>Start from importing our numerical schemes from yesterday’s lecture.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">explicit_euler</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Nmax</span><span class="p">):</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">y0</span><span class="p">]</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="p">[</span><span class="n">t0</span><span class="p">]</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nmax</span>
    <span class="k">while</span> <span class="n">ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ts</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ys</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">heun</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Nmax</span><span class="p">):</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">y0</span><span class="p">]</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="p">[</span><span class="n">t0</span><span class="p">]</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nmax</span>
    <span class="k">while</span> <span class="n">ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1</span><span class="p">)</span>
        <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="n">k2</span><span class="p">))</span>
        <span class="n">ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ts</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ys</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<!-- --- begin solution of exercise --- -->
<p><strong>Solution.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># rhs of IVP</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">y</span>

<span class="c1"># Exact solution to compare against</span>
<span class="n">y_ex</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">y0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lam</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t0</span><span class="p">))</span>

<span class="n">Nmax_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">]</span>

<span class="n">errs</span><span class="p">,</span> <span class="n">eocs</span> <span class="o">=</span> <span class="n">compute_eoc</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Nmax_list</span><span class="p">,</span> <span class="n">explicit_euler</span><span class="p">,</span> <span class="n">y_ex</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eocs</span><span class="p">)</span>

<span class="n">errs</span><span class="p">,</span> <span class="n">eocs</span> <span class="o">=</span> <span class="n">compute_eoc</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Nmax_list</span><span class="p">,</span> <span class="n">heun</span><span class="p">,</span> <span class="n">y_ex</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eocs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For Nmax =   4, max ||y(t_i) - y_i||= 2.769e-01
For Nmax =   8, max ||y(t_i) - y_i||= 1.525e-01
For Nmax =  16, max ||y(t_i) - y_i||= 8.035e-02
For Nmax =  32, max ||y(t_i) - y_i||= 4.129e-02
For Nmax =  64, max ||y(t_i) - y_i||= 2.094e-02
For Nmax = 128, max ||y(t_i) - y_i||= 1.054e-02
[0.86045397 0.9243541  0.96050605 0.9798056  0.98978691]
For Nmax =   4, max ||y(t_i) - y_i||= 2.343e-02
For Nmax =   8, max ||y(t_i) - y_i||= 6.441e-03
For Nmax =  16, max ||y(t_i) - y_i||= 1.688e-03
For Nmax =  32, max ||y(t_i) - y_i||= 4.322e-04
For Nmax =  64, max ||y(t_i) - y_i||= 1.093e-04
For Nmax = 128, max ||y(t_i) - y_i||= 2.749e-05
[1.86285442 1.93161644 1.96595738 1.98303072 1.99153035]
</pre></div>
</div>
</div>
</div>
<!-- --- end solution of exercise --- -->
<!-- --- end exercise --- -->
</section>
<section id="a-general-convergence-result-for-one-step-methods">
<h2><span class="section-number">69.8. </span>A general convergence result for one step methods<a class="headerlink" href="#a-general-convergence-result-for-one-step-methods" title="Link to this heading">#</a></h2>
</section>
<section id="theorem-1-convergence-of-one-step-methods">
<h2><span class="section-number">69.9. </span>Theorem 1: Convergence of one-step methods<a class="headerlink" href="#theorem-1-convergence-of-one-step-methods" title="Link to this heading">#</a></h2>
<div id="ode:thm:osm-convergence-theory"></div>
Assume that there exist positive constants $M$ and $D$ such that the
increment function satisfies
<div class="math notranslate nohighlight">
\[
\| \mathbf{\Phi}(t,\mathbf{y};\tau) - \mathbf{\Phi}(t,\mathbf{z};\tau) \| \leq M \| \mathbf{y}-\mathbf{z} \|
\]</div>
<p>and
the local trunctation error satisfies</p>
<div class="math notranslate nohighlight">
\[
\| {\boldsymbol \eta}(t, \tau) \| =
\| \mathbf{y}(t+\tau) - \left (\mathbf{y}(t) + \tau \mathbf{\Phi}(t, \mathbf{y}(t),
\tau)\right) \|
\leqslant D \tau^{p+1}
\]</div>
<p>for all <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> in the neighbourhood of the
solution.</p>
<p>In that case, the global error satisfies</p>
<div class="math notranslate nohighlight">
\[
\max_{k \in \{0,1,\ldots,N_t\}}
\|e_k(t_k,\tau_k) \|
\leqslant C \tau^p, \qquad C =
\frac{e^{M(T-t_0)}-1}{M}D,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau = \max_{k \in \{0,1,\ldots,N_t\}} \tau_k\)</span>.</p>
<p><strong>Proof.</strong>
We omit the proof here.</p>
<p>It can be proved that the first of these conditions are satisfied for
all the methods that will be considered here.</p>
<p><strong>Summary.</strong></p>
<p>The convergence theorem for one step methods can be summarized as</p>
<ul class="simple">
<li><p>“local truncation error behaves like <span class="math notranslate nohighlight">\(\mathcal{O}(\tau^{p+1})\)</span>” + “Increment
function satisfies a Lipschitz condition”
<span class="math notranslate nohighlight">\(\Rightarrow\)</span> “global truncation error behaves like <span class="math notranslate nohighlight">\(\mathcal{O}(\tau^{p})\)</span>”</p></li>
</ul>
<p>or equivalently,</p>
<ul class="simple">
<li><p>“consistency order <span class="math notranslate nohighlight">\(p\)</span>” + “Lipschitz condition for the Increment function”
<span class="math notranslate nohighlight">\(\Rightarrow\)</span> “convergence order <span class="math notranslate nohighlight">\(p\)</span>”.</p></li>
</ul>
</section>
<section id="convergence-properties-of-heun-s-method">
<h2><span class="section-number">69.10. </span>Convergence properties of Heun’s method<a class="headerlink" href="#convergence-properties-of-heun-s-method" title="Link to this heading">#</a></h2>
<p>Thanks to Theorem <a class="reference internal" href="#ode:thm:osm-convergence-theory"><span class="xref myst">Theorem 1: Convergence of one-step methods</span></a>,
we need to show two things to prove convergence and find the
corresponding convergence of a given one step methods:</p>
<ul class="simple">
<li><p>determine the local truncation error, expressed as a power series in the step
size <span class="math notranslate nohighlight">\(\tau\)</span></p></li>
<li><p>the condition
<span class="math notranslate nohighlight">\(\| {\boldsymbol \Phi}(t,{\boldsymbol y}, \tau) - {\boldsymbol \Phi}(t,{\boldsymbol z},\tau)
\| \leqslant  M
\| {\boldsymbol y} - {\boldsymbol z} \|\)</span></p></li>
</ul>
<p><strong>Determining the consistency order.</strong>
The local truncation error is found by making Taylor expansions of the
exact and the numerical solutions starting from the same point, and
compare. In practice, this is not trivial. For simplicity, we will
here do this for a scalar equation <span class="math notranslate nohighlight">\(y'(t)=f(t,y(t))\)</span>. The result is
valid for systems as well.</p>
<p>In the following, we will use the notation</p>
<div class="math notranslate nohighlight">
\[
f_t = \frac{\partial f}{\partial t}, \qquad f_y = \frac{\partial f}{\partial y}, 
\qquad f_{tt} = \frac{\partial^2 f}{\partial t^2} \qquad  f_{ty} 
= \frac{\partial^2f}{\partial t\partial y} \qquad\text{etc.}
\]</div>
<p>Further, we will surpress the arguments of the function <span class="math notranslate nohighlight">\(f\)</span> and its
derivatives. So <span class="math notranslate nohighlight">\(f\)</span> is to be understood as <span class="math notranslate nohighlight">\(f(t,y(t))\)</span> although it is
not explicitly written.</p>
<p>The Taylor expansion of the exact solution <span class="math notranslate nohighlight">\(y(t+\tau)\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
y(t+\tau)=y(t)+\tau y'(t) + \frac{\tau^2}{2}y''(t) + \frac{\tau^3}{6}y'''(t) + \dotsm.
\]</div>
<p>Higher derivatives of <span class="math notranslate nohighlight">\(y(t)\)</span> can be expressed in terms of the function
<span class="math notranslate nohighlight">\(f\)</span> by using the chain rule and the product rule for differentiation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    y'(t) &amp;= f, \\ 
    y''(t) &amp;= f_t  + f_y y' = f_t + f_y f,\\ 
    y'''(t) &amp;= f_{tt} + f_{ty} y' + f_{yt}f + f_{yy}y'f + f_yf_t +f_y f_y y' 
             = f_{tt}+2f_{ty}f+f_{yy}f^2 +f_yf_t+ (f_y)^2f.
\end{align*}
\end{split}\]</div>
<p>Find the series of the exact and the numerical solution around
<span class="math notranslate nohighlight">\(x_0,y_0\)</span> (any other point will do equally well). From the discussion
above, the series for the exact solution becomes</p>
<div class="math notranslate nohighlight">
\[
y(t_0+\tau) = y_0 + \tau f + \frac{\tau^2}{2}(f_t + f_y f) +
\frac{\tau^3}{6}(f_{tt}+2f_{ty}f+f_{yy}ff + f_yf_xf + f_yf_t+ (f_y)^2f
) + \dotsm,
\]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> and all its derivatives are evaluated in <span class="math notranslate nohighlight">\((t_0,y_0)\)</span>.</p>
<p>For the numerical solution we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
  k_1 &amp;= f(t_0,y_0) = f, 
  \\ 
  k_2 &amp;= f(t_0+\tau, y_0+\tau k_1) 
  \\ 
      &amp; = f + \tau f_t + f_y\tau k_1 + \frac{1}{2}f_{tt}\tau^2 + f_{ty}\tau \tau k_1 + \frac{1}{2}f_{yy}\tau^2 k_1^2 
       + \dotsm 
       \\ 
      &amp;= f + \tau(f_t + f_yf) + \frac{\tau^2}{2}(f_{tt} + 2f_{ty}f + f_{yy}f^2) + \dotsm, 
      \\ 
  y_1 &amp;= y_0 + \frac{\tau}{2}(k_1 + k_2)
       = y_0 + \frac{\tau}{2}(f + f + \tau(f_t + f_yf) + \frac{\tau^2}{2}(f_{tt} + 2f_{ty}k_1 + f_{yy}f^2)) + \dotsm 
       \\ 
      &amp;= y_0 + \tau f + \frac{\tau^2}{2}(f_t+f_yf)+ \frac{\tau^3}{4}(f_{tt} + 2f_{ty}f + f_{yy}f^2)  + \dotsm
\end{align*}
\end{split}\]</div>
<p>Thus the local truncation error will be</p>
<div class="math notranslate nohighlight">
\[
\eta(t_0, \tau) = y(t_0+\tau)-y_1 = \frac{\tau^3}{12}(-f_{tt}-2f_{ty}f-f_{yy}f^2 + 2f_yf_t + 2(f_y)^2f) + \dotsm
\]</div>
<p>The first nonzero term in the local truncation error series is called
<em>the principal error term</em>. For <span class="math notranslate nohighlight">\(\tau \)</span> sufficiently small this is the
term dominating the error, and this fact will be used later.</p>
<p>Although the series has been developed around the initial point,
series around <span class="math notranslate nohighlight">\(t_n, y(t_n)\)</span> will give similar results, and it is
possible to conclude that, given sufficient differentiability of <span class="math notranslate nohighlight">\(f\)</span>
there is a constant <span class="math notranslate nohighlight">\(D\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
\max_i |\eta(t_i, \tau)| \leq D\tau^3.
\]</div>
<p><em>Consequently, Heun’s method is of consistency order <span class="math notranslate nohighlight">\(2\)</span>.</em></p>
<p><strong>Lipschitz condition for <span class="math notranslate nohighlight">\(\Phi\)</span>.</strong>
Further, we have to prove the condition on the increment function
<span class="math notranslate nohighlight">\(\Phi(t,y)\)</span>. For <span class="math notranslate nohighlight">\(f\)</span> differentiable, there is for all <span class="math notranslate nohighlight">\(y,z\)</span> some <span class="math notranslate nohighlight">\(\xi\)</span>
between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> such that <span class="math notranslate nohighlight">\(f(t,y)-f(t,z) = f_y(t,\xi)(y-z)\)</span>. Let L
be a constant such that <span class="math notranslate nohighlight">\(|f_y|&lt;L\)</span>, and for all <span class="math notranslate nohighlight">\(x,y,z\)</span> of interest we
get</p>
<div class="math notranslate nohighlight">
\[
|f(t,y)-f(t,z)| \leq L |y-z|.
\]</div>
<p>The increment function for Heun’s method is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Phi(t,y) = \frac{1}{2}(f(t,y)+f(t+\tau,y+\tau f(t,y))). \\
\end{split}\]</div>
<p>By repeated use of the condition above and the triangle inequalitiy for absolute values we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
|\Phi(t,y)-\Phi(t,z)| &amp;= \frac{1}{2}|f(t,y)+f(t+\tau,y+f(t,y))-f(t,z)-\tau f(t+\tau,z+f(t,z)| 
\\ 
&amp;\leq \frac{1}{2}\big(|f(t,y)-f(t,z)|+|f(t+\tau,y+\tau f(t,y))-f(t+\tau,z+\tau f(t,z)| \big) 
\\ 
&amp;\leq \frac{1}{2}\big(L|y-z| + L|y+\tau f(t,y)-z-\tau f(t,z)| \big) 
\\ 
&amp;\leq \frac{1}{2}\big(2L|y-z|+\tau L^2|y-z|\big) 
\\ 
&amp; = (L+\frac{\tau}{2}L^2)|y-z|.
\end{align*}
\end{split}\]</div>
<p>Assuming that the step size <span class="math notranslate nohighlight">\(\tau\)</span> is bounded upward by some <span class="math notranslate nohighlight">\(\tau_0\)</span>,
we can conclude that</p>
<div class="math notranslate nohighlight">
\[
|\Phi(t,y)-\Phi(t,z)| \leq M|y-z|, \qquad M=L+\frac{\tau_0}{2}L^2.
\]</div>
<p>Thanks to Theorem <a class="reference internal" href="#ode:thm:osm-convergence-theory"><span class="xref myst">Theorem 1: Convergence of one-step methods</span></a>, we can conclude
that Heun’s method is convergent of order 2.</p>
<!-- !bnotice -->
<!-- In the next part, when we introduce a large class of -->
<!-- one step methods known as Runge-Kutta methods, of which -->
<!-- Euler's and Heun's method are particular instances. -->
<!-- For Runge-Kutta methods we will learn about some -->
<!-- algebraic conditions known as order conditions. -->
<!-- !bnotice --></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./TMA4125"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="SimpleCovidModel.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">67. </span>A simple epidemic model for Covid 19 and its numerical solution</p>
      </div>
    </a>
    <a class="right-next"
       href="Introduction.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">70. </span>Introduction to TMA4125</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">68. Numerical solution of ordinary differential equations: One step methods</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#one-step-methods">69. One Step Methods</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-1-one-step-methods">69.1. Definition 1: One step methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-increment-functions-for-euler-and-heun">69.2. Example 1: Increment functions for Euler and Heun</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#local-and-global-truncation-error-of-osm">69.3. Local and global truncation error of OSM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-2-local-truncation-error">69.4. Definition 2: Local truncation error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">69.5. Example 2:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-3-global-truncation-error">69.6. Definition 3: Global truncation error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-convergence-order-for-euler-and-heun">69.7. Exercise 1: Convergence order for Euler and Heun</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-general-convergence-result-for-one-step-methods">69.8. A general convergence result for one step methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theorem-1-convergence-of-one-step-methods">69.9. Theorem 1: Convergence of one-step methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convergence-properties-of-heun-s-method">69.10. Convergence properties of Heun’s method</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Carlos Aznarán
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright February 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Jun 03, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
    This webpage is distributed under the terms of the
    <a href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License</a>
    which permits use, duplication, adaptation, distribution and
    reproduction in any medium or format, as long as you give appropriate
    credit to the original author(s) and the source, provide a link to the Creative
    Commons license and indicate if changes were made.
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>