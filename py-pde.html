
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>9. py-pde tutorial &#8212; PDE tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'py-pde';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="10. findiff tutorial" href="findiff.html" />
    <link rel="prev" title="8. kernex" href="jax/kernex.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Jun 03, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="PDE tutorial - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="PDE tutorial - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    PDE Tutorial
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">The Finite Difference Method</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notes/pde.html">1. Partial Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/fda.html">2. Finite-Difference Approximations</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/elliptic.html">3. Elliptic Partial Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/octave.html">4. octave</a></li>
<li class="toctree-l1"><a class="reference internal" href="pystencils.html">5. pystencils</a></li>
<li class="toctree-l1"><a class="reference internal" href="jax/jax.html">6. Introduction to JAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="jax/finitediffx.html">7. finitediffx</a></li>
<li class="toctree-l1"><a class="reference internal" href="jax/kernex.html">8. kernex</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">9. <code class="docutils literal notranslate"><span class="pre">py-pde</span></code> tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="findiff.html">10. <code class="docutils literal notranslate"><span class="pre">findiff</span></code> tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="symbolic-findiff.html">11. Symbolic <code class="docutils literal notranslate"><span class="pre">findiff</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="solve-findiff.html">12. Solve with <code class="docutils literal notranslate"><span class="pre">findiff</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="advectionper.html">13. <code class="docutils literal notranslate"><span class="pre">AdvectionPer.m</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusioncrancknic.html">14. <code class="docutils literal notranslate"><span class="pre">DiffusionCrankNic.m</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="advection-pystencils.html">15. Advection pystencils example</a></li>
<li class="toctree-l1"><a class="reference internal" href="petsc.html">16. 1D heat diffusion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Finite Volume Method</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="clawpack.html">1D advection equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Mimetic Finite Difference Method</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="mimetic/mole.html">mole</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Simulating Fluid Flows Using Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="fluids/lecture1.html">17. Introduction to Computational Fluid Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="fluids/lecture2.html">18. Finite Differences - First Derivative</a></li>

<li class="toctree-l1"><a class="reference internal" href="fluids/lecture3.html">20. Finite differences in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="fluids/lecture4.html">21. Second derivative - 1D heat conduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="fluids/lecture5.html">22. Introduction to Finite Volume Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="fluids/lecture6.html">23. CFD Relevant Python Statements | While | For</a></li>
<li class="toctree-l1"><a class="reference internal" href="fluids/lecture7.html">24. Conduction Visualization Python Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="fluids/lecture8.html">25. Generalized FVM Formulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="fluids/lecture10.html">26. 0</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computers, Waves, Simulations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="waves/W2_P1.html">27. First Derivative</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W2_P2.html">28. Second Derivative</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W2_P3.html">29. High-Order Taylor Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W3_P1_Gaussian.html">30. Acoustic Waves 1D I</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W3_P2_Gaussian_analytical.html">31. Acoustic Waves 1D II</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W4_ac1d_optimal_operators.html">32. Acoustic Waves 1D - Optimal Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W4_fd_ac2d_heterogeneous_solutions.html">33. Acoustic Waves 2D - Heterogeneous case</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W4_fd_ac2d_homogeneous.html">34. Acoustic Waves 2D - Homogeneous case</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W4_fd_advection_1d.html">35. Advection equation 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W4_fd_elastic1d_staggered_solution.html">36. Grid-Staggering Elastic 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W5_ps_cheby_derivative_solution.html">37. The Pseudo-Spectral Method - Numerical Derivatives based on a Derivative Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W5_ps_cheby_elastic_1d_solution.html">38. The Pseudo-Spectral Method - Elastic Wave Equation 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W5_ps_fourier_acoustic_1d.html">39. The Pseudo-Spectral Method - Acoustic Waves in 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W5_ps_fourier_acoustic_2d.html">40. The Pseudo-Spectral Method - Acoustic Waves in 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W6_fe_static_elasticity.html">41. The Finite Element Method - Static Elasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W7_fe_elastic_1d_solution.html">42. The Finite Element Method - Elastic Wave Equation 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W8_se_Lagrange_interpolation_simple.html">43. The Spectral Element Method - Interpolation with Lagrange Polynomials</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W8_se_numerical_integration_GLL.html">44. The Spectral Element Method - Numerical Integration - The Gauss-Lobatto-Legendre approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W9_se_hetero_1d_solution.html">45. Spectral Element Method - Elastic Wave Equation 1D, Heterogeneous case</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves/W9_se_homo_1d_solution.html">46. Spectral Element Method - Elastic Wave Equation 1D - Homogeneous Case</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Differential equations and Fourier analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="TMA4125/fourier_series_supplemental_material.html">47. Fourier series: supplemental material</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMA4125/LagrangeInterpolation.html">48. Polynomial interpolation: Lagrange interpolation</a></li>


<li class="toctree-l1"><a class="reference internal" href="TMA4125/RungeKuttaNuMeODE.html">51. Numerical solution of ordinary differential equations: High order Runge-Kutta methods</a></li>

<li class="toctree-l1"><a class="reference internal" href="TMA4125/TwoPointBoundaryProblems.html">53. Finite difference methods for two-point value problems</a></li>



<li class="toctree-l1"><a class="reference internal" href="TMA4125/CompositeQuadrature.html">57. Numerical integration: Part II</a></li>



<li class="toctree-l1"><a class="reference internal" href="TMA4125/GaussQuadrature.html">61. Numerical integration: Part IV</a></li>


<li class="toctree-l1"><a class="reference internal" href="TMA4125/lecture_01_introduction.html">64. Introduction to TMA4125</a></li>


<li class="toctree-l1"><a class="reference internal" href="TMA4125/SimpleCovidModel.html">67. A simple epidemic model for Covid 19 and its numerical solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMA4125/ErrorAnalysisNuMeODE.html">68. Numerical solution of ordinary differential equations: One step methods</a></li>

<li class="toctree-l1"><a class="reference internal" href="TMA4125/Introduction.html">70. Introduction to TMA4125</a></li>


<li class="toctree-l1"><a class="reference internal" href="TMA4125/NewtonInterpolation.html">73. Polynomial interpolation: Newton interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="TMA4125/SimpleQuadrature.html">74. Numerical integration</a></li>



<li class="toctree-l1"><a class="reference internal" href="TMA4125/ErrorTheoryInterpolation.html">78. Polynomial interpolation: Error theory</a></li>

<li class="toctree-l1"><a class="reference internal" href="TMA4125/IntroductionNuMeODE.html">80. Numerical solution of ordinary differential equations: Euler’s and Heun’s method</a></li>





<li class="toctree-l1"><a class="reference internal" href="TMA4125/NumericalMethodsHeatEquation.html">86. Numerical methods for the heat equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Finite Difference Computing with PDEs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="hplgit/vibration.html">87. Lecture 3</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">End Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cpp-review-dune/python-pde" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cpp-review-dune/python-pde/edit/main/pde-book/py-pde.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cpp-review-dune/python-pde/issues/new?title=Issue%20on%20page%20%2Fpy-pde.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/py-pde.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>py-pde tutorial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grids">9.1. Grids</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fields">9.2. Fields</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#differential-operators">9.3. Differential operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-fields">9.4. Vector Fields</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#field-collections">9.5. Field collections</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-pdes">9.6. Solving PDEs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trackers">9.7. Trackers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic">9.8. Stochastic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#poisson">9.9. Poisson</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-equation">9.10. Diffusion equation</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="py-pde-tutorial">
<h1><span class="section-number">9. </span><code class="docutils literal notranslate"><span class="pre">py-pde</span></code> tutorial<a class="headerlink" href="#py-pde-tutorial" title="Link to this heading">#</a></h1>
<p>Homesite: <a class="reference external" href="https://www.zwickergroup.org/software">https://www.zwickergroup.org/software</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="kn">from</span> <span class="nn">pde</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">PDE</span><span class="p">,</span>
    <span class="n">CahnHilliardPDE</span><span class="p">,</span>
    <span class="n">CartesianGrid</span><span class="p">,</span>
    <span class="n">Controller</span><span class="p">,</span>
    <span class="n">CylindricalSymGrid</span><span class="p">,</span>
    <span class="n">DiffusionPDE</span><span class="p">,</span>
    <span class="n">ExplicitSolver</span><span class="p">,</span>
    <span class="n">FieldCollection</span><span class="p">,</span>
    <span class="n">FileStorage</span><span class="p">,</span>
    <span class="n">KPZInterfacePDE</span><span class="p">,</span>
    <span class="n">MemoryStorage</span><span class="p">,</span>
    <span class="n">PDEBase</span><span class="p">,</span>
    <span class="n">PlotTracker</span><span class="p">,</span>
    <span class="n">PolarSymGrid</span><span class="p">,</span>
    <span class="n">PrintTracker</span><span class="p">,</span>
    <span class="n">ScalarField</span><span class="p">,</span>
    <span class="n">ScipySolver</span><span class="p">,</span>
    <span class="n">SphericalSymGrid</span><span class="p">,</span>
    <span class="n">UnitGrid</span><span class="p">,</span>
    <span class="n">VectorField</span><span class="p">,</span>
    <span class="n">solve_poisson_equation</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pde.grids.operators.cartesian</span> <span class="kn">import</span> <span class="n">_make_derivative2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[63d0ce6eb901:04188] shmem: mmap: an error occurred while determining whether or not /tmp/ompi.63d0ce6eb901.33333/jf.0/868483072/shared_mem_cuda_pool.63d0ce6eb901 could be created.
[63d0ce6eb901:04188] create_and_attach: unable to create shared memory BTL coordinating structure :: size 134217728 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;igvs4ZKLjy8&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="400"
            height="300"
            src="https://www.youtube.com/embed/igvs4ZKLjy8"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;contextlib.ExitStack at 0x7ff3dd5d19d0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span>
    <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;float&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:0.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">},</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">50</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="grids">
<h2><span class="section-number">9.1. </span>Grids<a class="headerlink" href="#grids" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Area=</span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/28338168517608d3154bb3155c725cd36c4e38ba2442c690c17900f48b902211.png"><img alt="_images/28338168517608d3154bb3155c725cd36c4e38ba2442c690c17900f48b902211.png" src="_images/28338168517608d3154bb3155c725cd36c4e38ba2442c690c17900f48b902211.png" style="width: 1293px; height: 1348px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Area=</span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">volume</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/817665edd62f4db11a00e16623e5b723040f6c98248ae61d123900a1b01ed158.png"><img alt="_images/817665edd62f4db11a00e16623e5b723040f6c98248ae61d123900a1b01ed158.png" src="_images/817665edd62f4db11a00e16623e5b723040f6c98248ae61d123900a1b01ed158.png" style="width: 1720px; height: 983px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">PolarSymGrid</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Area=</span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">volume</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/cc93e1874d720f5131505adac5171561f5038b65bb866ef6036c4e326a4d4ccb.png"><img alt="_images/cc93e1874d720f5131505adac5171561f5038b65bb866ef6036c4e326a4d4ccb.png" src="_images/cc93e1874d720f5131505adac5171561f5038b65bb866ef6036c4e326a4d4ccb.png" style="width: 1304px; height: 1348px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">SphericalSymGrid</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Area=</span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">volume</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/0d372ec1201ce556a8dc0de7ff58801d4d00a8afcf9d78f273f4130ecee62691.png"><img alt="_images/0d372ec1201ce556a8dc0de7ff58801d4d00a8afcf9d78f273f4130ecee62691.png" src="_images/0d372ec1201ce556a8dc0de7ff58801d4d00a8afcf9d78f273f4130ecee62691.png" style="width: 1304px; height: 1348px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">PolarSymGrid</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Area=</span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">volume</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/64bea9af856219604734dc25b5aa831dd40368f659456440b7fc6a6543da89f8.png"><img alt="_images/64bea9af856219604734dc25b5aa831dd40368f659456440b7fc6a6543da89f8.png" src="_images/64bea9af856219604734dc25b5aa831dd40368f659456440b7fc6a6543da89f8.png" style="width: 1304px; height: 1348px;" /></a>
</div>
</div>
</section>
<section id="fields">
<h2><span class="section-number">9.2. </span>Fields<a class="headerlink" href="#fields" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.0 1.0 1.0 ... 1.0 1.0 1.0]
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]
 ...
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">+=</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[5.0 5.0 5.0 ... 5.0 5.0 5.0]
 [5.0 5.0 5.0 ... 5.0 5.0 5.0]
 [5.0 5.0 5.0 ... 5.0 5.0 5.0]
 ...
 [5.0 5.0 5.0 ... 5.0 5.0 5.0]
 [5.0 5.0 5.0 ... 5.0 5.0 5.0]
 [5.0 5.0 5.0 ... 5.0 5.0 5.0]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">128</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/76586b3243888fb9e7de9fb0ebc7d59a9b1204c63f36097d32515835c7c0cdf4.png"><img alt="_images/76586b3243888fb9e7de9fb0ebc7d59a9b1204c63f36097d32515835c7c0cdf4.png" src="_images/76586b3243888fb9e7de9fb0ebc7d59a9b1204c63f36097d32515835c7c0cdf4.png" style="width: 1763px; height: 871px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7ff3c559a4c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.0 1.0 2.0 ... 29.0 30.0 31.0]
 [32.0 33.0 34.0 ... 61.0 62.0 63.0]
 [64.0 65.0 66.0 ... 93.0 94.0 95.0]
 ...
 [4000.0 4001.0 4002.0 ... 4029.0 4030.0 4031.0]
 [4032.0 4033.0 4034.0 ... 4061.0 4062.0 4063.0]
 [4064.0 4065.0 4066.0 ... 4093.0 4094.0 4095.0]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span><span class="o">.</span><span class="n">interpolate</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(669.5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_normal</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
<span class="n">field</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Average=</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">average</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/100c41588351f25340bb4d6a9c016643ffe187cddec3360a5676fbf03466b602.png"><img alt="_images/100c41588351f25340bb4d6a9c016643ffe187cddec3360a5676fbf03466b602.png" src="_images/100c41588351f25340bb4d6a9c016643ffe187cddec3360a5676fbf03466b602.png" style="width: 1733px; height: 931px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_colored</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Random field&quot;</span><span class="p">)</span>
<span class="n">field</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/ed05a9547ec35b6ecbaf12d4aceb19af966eb00bcffddd94e195e27c417ce105.png"><img alt="_images/ed05a9547ec35b6ecbaf12d4aceb19af966eb00bcffddd94e195e27c417ce105.png" src="_images/ed05a9547ec35b6ecbaf12d4aceb19af966eb00bcffddd94e195e27c417ce105.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7ff3bd8dd0c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;random_field.hdf&quot;</span><span class="p">)</span>
<span class="o">!(</span>ls<span class="w"> </span>random_field.hdf<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">field</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;random_field.hdf&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;(ls random_field.hdf)&#39;</span><span class="p">)</span>

<span class="nn">File /usr/lib/python3.12/site-packages/pde/fields/base.py:304,</span> in <span class="ni">FieldBase.to_file</span><span class="nt">(self, filename, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span> <span class="k">if</span> <span class="n">extension</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;.hdf&quot;</span><span class="p">,</span> <span class="s2">&quot;.hdf5&quot;</span><span class="p">,</span> <span class="s2">&quot;.he5&quot;</span><span class="p">,</span> <span class="s2">&quot;.h5&quot;</span><span class="p">}:</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span>     <span class="c1"># save data in hdf5 format</span>
<span class="ne">--&gt; </span><span class="mi">304</span>     <span class="kn">import</span> <span class="nn">h5py</span>
<span class="g g-Whitespace">    </span><span class="mi">306</span>     <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">307</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_write_hdf_dataset</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;h5py&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_loaded</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;random_field.hdf&quot;</span><span class="p">)</span>
<span class="n">field_loaded</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/38b10e7e6de6730a1695766126cf74698b5dd8147e997bd6aeaa74ef86c9eb65.png"><img alt="_images/38b10e7e6de6730a1695766126cf74698b5dd8147e997bd6aeaa74ef86c9eb65.png" src="_images/38b10e7e6de6730a1695766126cf74698b5dd8147e997bd6aeaa74ef86c9eb65.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c9f7dfc0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slice_x</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">slice</span><span class="p">({</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">})</span>
<span class="n">slice_x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Slice field along line $y=\pi$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/4ffb29658320ee08d4abe750c44196bfa1016a2ae6160874c9b82901db3aac3f.png"><img alt="_images/4ffb29658320ee08d4abe750c44196bfa1016a2ae6160874c9b82901db3aac3f.png" src="_images/4ffb29658320ee08d4abe750c44196bfa1016a2ae6160874c9b82901db3aac3f.png" style="width: 1754px; height: 931px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">project_x</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">project_x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Projection by integration along $y$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/47e86c66106f68f66907f7b3a863cee86bc91d092f57f60807e96b2f38499851.png"><img alt="_images/47e86c66106f68f66907f7b3a863cee86bc91d092f57f60807e96b2f38499851.png" src="_images/47e86c66106f68f66907f7b3a863cee86bc91d092f57f60807e96b2f38499851.png" style="width: 1754px; height: 931px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>
<span class="n">field</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Average=</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">average</span><span class="si">:</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/bbd72c5f158e3748b32746ca0d5750c68f139b29b01e2fb7e8c7b2a29eae4131.png"><img alt="_images/bbd72c5f158e3748b32746ca0d5750c68f139b29b01e2fb7e8c7b2a29eae4131.png" src="_images/bbd72c5f158e3748b32746ca0d5750c68f139b29b01e2fb7e8c7b2a29eae4131.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c9315400&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="differential-operators">
<h2><span class="section-number">9.3. </span>Differential operators<a class="headerlink" href="#differential-operators" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>
<span class="n">laplace_dir</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">laplace_dir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of field with Dirichlet boundary conditions&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/77151a8bfa46af43a8ad46a9720b92822d422f7eee6f078f04b174274d815262.png"><img alt="_images/77151a8bfa46af43a8ad46a9720b92822d422f7eee6f078f04b174274d815262.png" src="_images/77151a8bfa46af43a8ad46a9720b92822d422f7eee6f078f04b174274d815262.png" style="width: 1754px; height: 931px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">laplace_neu</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">laplace_neu</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of field with Neumann boundary conditions&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/df7912c92565364da8f8f64af44013b5091dad2a755fa8b2592f53d1e842b091.png"><img alt="_images/df7912c92565364da8f8f64af44013b5091dad2a755fa8b2592f53d1e842b091.png" src="_images/df7912c92565364da8f8f64af44013b5091dad2a755fa8b2592f53d1e842b091.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c9f99a00&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">laplace_mix</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}])</span>
<span class="n">laplace_mix</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of field with mixed boundary conditions&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/15a282822fc0c50fd0f9f6ed2b0af46fcf9420aefd7c1542ebe05bc4ab1ba7b6.png"><img alt="_images/15a282822fc0c50fd0f9f6ed2b0af46fcf9420aefd7c1542ebe05bc4ab1ba7b6.png" src="_images/15a282822fc0c50fd0f9f6ed2b0af46fcf9420aefd7c1542ebe05bc4ab1ba7b6.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8fd3d40&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_per</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">field_per</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid_per</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>
<span class="n">laplace_per</span> <span class="o">=</span> <span class="n">field_per</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="s2">&quot;periodic&quot;</span><span class="p">)</span>
<span class="n">laplace_per</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of periodic field&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/48cab20b3d7a4c9f252093e2f6ed9db8f7a52789697f0d0b3742d8ac8aede62f.png"><img alt="_images/48cab20b3d7a4c9f252093e2f6ed9db8f7a52789697f0d0b3742d8ac8aede62f.png" src="_images/48cab20b3d7a4c9f252093e2f6ed9db8f7a52789697f0d0b3742d8ac8aede62f.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8df19c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_mixed</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">field_mixed</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid_mixed</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>

<span class="n">laplace_mixed</span> <span class="o">=</span> <span class="n">field_mixed</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}])</span>
<span class="n">laplace_mixed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of mixed field&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png"><img alt="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png" src="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c91caa80&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">laplace_mixed</span> <span class="o">=</span> <span class="n">field_mixed</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="s2">&quot;natural&quot;</span><span class="p">)</span>
<span class="n">laplace_mixed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of mixed field&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png"><img alt="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png" src="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8d8f200&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="vector-fields">
<h2><span class="section-number">9.4. </span>Vector Fields<a class="headerlink" href="#vector-fields" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_per</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">vector_field</span> <span class="o">=</span> <span class="n">VectorField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid_per</span><span class="p">,</span> <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;cos(x)&quot;</span><span class="p">])</span>
<span class="n">vector_field</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/87f3f1dbae0a9c8cc5dc89fd745bb2ac1cf576379b695000a30a255d2d82bd86.png"><img alt="_images/87f3f1dbae0a9c8cc5dc89fd745bb2ac1cf576379b695000a30a255d2d82bd86.png" src="_images/87f3f1dbae0a9c8cc5dc89fd745bb2ac1cf576379b695000a30a255d2d82bd86.png" style="width: 1754px; height: 931px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_per</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid_per</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>
<span class="n">field_grad</span> <span class="o">=</span> <span class="n">field_per</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="s2">&quot;natural&quot;</span><span class="p">)</span>
<span class="n">field_grad</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/9551650093128e7839a7cdf70f0bf0ae6ed0d64137ba47b61573dcf1b0eb1c65.png"><img alt="_images/9551650093128e7839a7cdf70f0bf0ae6ed0d64137ba47b61573dcf1b0eb1c65.png" src="_images/9551650093128e7839a7cdf70f0bf0ae6ed0d64137ba47b61573dcf1b0eb1c65.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8ba21c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">field_grad</span><span class="o">.</span><span class="n">average</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0 -0.0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_grad</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;quiver&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Quiver plot of the gradient field&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/6d1a74ace3652f29d813d236fffc375989d5263a92d431979473c9f7dfc1ac88.png"><img alt="_images/6d1a74ace3652f29d813d236fffc375989d5263a92d431979473c9f7dfc1ac88.png" src="_images/6d1a74ace3652f29d813d236fffc375989d5263a92d431979473c9f7dfc1ac88.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8f54900&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_grad</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;streamplot&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Stream plot of the gradient field&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/2599cf7f5c385caefee17422240dc77a07b37ea305a249a050f7faca2251a425.png"><img alt="_images/2599cf7f5c385caefee17422240dc77a07b37ea305a249a050f7faca2251a425.png" src="_images/2599cf7f5c385caefee17422240dc77a07b37ea305a249a050f7faca2251a425.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c933bac0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gradient_norm</span> <span class="o">=</span> <span class="n">field_grad</span><span class="o">.</span><span class="n">to_scalar</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">)</span>
<span class="n">gradient_norm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Norm of gradient of field&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/a80f76b154eff66aebec51fbee44c20b7555bd11e5cfbc641c9e4310ddb8aa71.png"><img alt="_images/a80f76b154eff66aebec51fbee44c20b7555bd11e5cfbc641c9e4310ddb8aa71.png" src="_images/a80f76b154eff66aebec51fbee44c20b7555bd11e5cfbc641c9e4310ddb8aa71.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c89930c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_x</span> <span class="o">=</span> <span class="n">field_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">comp_y</span> <span class="o">=</span> <span class="n">field_grad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$x$-component of gradient&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/ff56e92669f13927e11cda20e82234fe47870cbace6286d3dbebf548dbf82c44.png"><img alt="_images/ff56e92669f13927e11cda20e82234fe47870cbace6286d3dbebf548dbf82c44.png" src="_images/ff56e92669f13927e11cda20e82234fe47870cbace6286d3dbebf548dbf82c44.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8892040&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;$y$-component of gradient&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/60e84872b056e781105f1eb099bec7dc540d16a56fb493548d48cc33a36ad216.png"><img alt="_images/60e84872b056e781105f1eb099bec7dc540d16a56fb493548d48cc33a36ad216.png" src="_images/60e84872b056e781105f1eb099bec7dc540d16a56fb493548d48cc33a36ad216.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c890ab40&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gradient_expl_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">comp_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">comp_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">gradient_expl_norm</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">gradient_norm</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_hess</span> <span class="o">=</span> <span class="n">field_grad</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="s2">&quot;natural&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hessian of field&quot;</span><span class="p">)</span>
<span class="n">field_hess</span><span class="o">.</span><span class="n">attributes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;class&#39;: &#39;Tensor2Field&#39;,
 &#39;grid&#39;: CartesianGrid(bounds=((0.0, 12.566370614359172), (0.0, 6.283185307179586)), shape=(128, 32), periodic=[True, True]),
 &#39;label&#39;: &#39;Hessian of field&#39;,
 &#39;dtype&#39;: dtype(&#39;float64&#39;)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_hess</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/80731a3f6517ba271bdd215f4d3625f1819f98de96dfff1f33dd49da586d5fce.png"><img alt="_images/80731a3f6517ba271bdd215f4d3625f1819f98de96dfff1f33dd49da586d5fce.png" src="_images/80731a3f6517ba271bdd215f4d3625f1819f98de96dfff1f33dd49da586d5fce.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8961280&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scalar_field</span> <span class="o">=</span> <span class="n">field_grad</span> <span class="o">@</span> <span class="n">field_hess</span> <span class="o">@</span> <span class="n">field_grad</span>
<span class="n">scalar_field</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gradient . Hessian . Gradient&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1ad0929ef5f06230f4abdeaa4abb602b3a6d558d2becf170e3dada221263fd5f.png"><img alt="_images/1ad0929ef5f06230f4abdeaa4abb602b3a6d558d2becf170e3dada221263fd5f.png" src="_images/1ad0929ef5f06230f4abdeaa4abb602b3a6d558d2becf170e3dada221263fd5f.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8584340&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scalar_field</span><span class="o">.</span><span class="n">slice</span><span class="p">({</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/fc4aa542afa235811f15d485ec1ecd239b8fcbcb6b3b9fdd33dcd2018357f417.png"><img alt="_images/fc4aa542afa235811f15d485ec1ecd239b8fcbcb6b3b9fdd33dcd2018357f417.png" src="_images/fc4aa542afa235811f15d485ec1ecd239b8fcbcb6b3b9fdd33dcd2018357f417.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8908840&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="field-collections">
<h2><span class="section-number">9.5. </span>Field collections<a class="headerlink" href="#field-collections" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_pol</span> <span class="o">=</span> <span class="n">PolarSymGrid</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">scalar_field1</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span>
    <span class="n">grid</span><span class="o">=</span><span class="n">grid_pol</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;r**2&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Increasing&quot;</span>
<span class="p">)</span>
<span class="n">scalar_field2</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span>
    <span class="n">grid</span><span class="o">=</span><span class="n">grid_pol</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;1/r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Decreasing&quot;</span>
<span class="p">)</span>
<span class="n">collection</span> <span class="o">=</span> <span class="n">FieldCollection</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">scalar_field1</span><span class="p">,</span> <span class="n">scalar_field2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span><span class="o">.</span><span class="n">attributes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;class&#39;: &#39;FieldCollection&#39;,
 &#39;label&#39;: None,
 &#39;dtype&#39;: dtype(&#39;float64&#39;),
 &#39;fields&#39;: [{&#39;class&#39;: &#39;ScalarField&#39;,
   &#39;grid&#39;: PolarSymGrid(radius=(2, 7), shape=(32,)),
   &#39;label&#39;: &#39;Increasing&#39;,
   &#39;dtype&#39;: dtype(&#39;float64&#39;)},
  {&#39;class&#39;: &#39;ScalarField&#39;,
   &#39;grid&#39;: PolarSymGrid(radius=(2, 7), shape=(32,)),
   &#39;label&#39;: &#39;Decreasing&#39;,
   &#39;dtype&#39;: dtype(&#39;float64&#39;)}]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/b34359d769a78562e4efceae2d9a6250b1a49bb339471d8b57005ab735debcf1.png"><img alt="_images/b34359d769a78562e4efceae2d9a6250b1a49bb339471d8b57005ab735debcf1.png" src="_images/b34359d769a78562e4efceae2d9a6250b1a49bb339471d8b57005ab735debcf1.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;pde.tools.plotting.PlotReference at 0x7f23c85e9e80&gt;,
 &lt;pde.tools.plotting.PlotReference at 0x7f23c86acd80&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/c1db9335a1f0880a6500f6b21b696b382290071a587d1395f844fc4cdd881af7.png"><img alt="_images/c1db9335a1f0880a6500f6b21b696b382290071a587d1395f844fc4cdd881af7.png" src="_images/c1db9335a1f0880a6500f6b21b696b382290071a587d1395f844fc4cdd881af7.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;pde.tools.plotting.PlotReference at 0x7f23c8ced500&gt;,
 &lt;pde.tools.plotting.PlotReference at 0x7f23c90d6640&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">collection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">collection</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/ac3660af69adbdd68de2e743d37dbd452cc8ff0fa484c1701fc1465c3f10f2de.png"><img alt="_images/ac3660af69adbdd68de2e743d37dbd452cc8ff0fa484c1701fc1465c3f10f2de.png" src="_images/ac3660af69adbdd68de2e743d37dbd452cc8ff0fa484c1701fc1465c3f10f2de.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c8d8cac0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">96</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_colored</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span>
<span class="n">vf</span> <span class="o">=</span> <span class="n">VectorField</span><span class="o">.</span><span class="n">random_harmonic</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">modes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fc</span> <span class="o">=</span> <span class="n">FieldCollection</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">sf</span><span class="p">,</span> <span class="n">vf</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/3bacdf32fafb3065f611486f2c9eb410288381d5c86758c80e3fd39ba0037169.png"><img alt="_images/3bacdf32fafb3065f611486f2c9eb410288381d5c86758c80e3fd39ba0037169.png" src="_images/3bacdf32fafb3065f611486f2c9eb410288381d5c86758c80e3fd39ba0037169.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;pde.tools.plotting.PlotReference at 0x7f23c776cc40&gt;,
 &lt;pde.tools.plotting.PlotReference at 0x7f23c777aa40&gt;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving-pdes">
<h2><span class="section-number">9.6. </span>Solving PDEs<a class="headerlink" href="#solving-pdes" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;exp(-(x**2 + y**2) * 100)&quot;</span><span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Initial state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/fe9cc8503c15fd31e1676c61262eac361c646d8fc75a847b347495d296c1b864.png"><img alt="_images/fe9cc8503c15fd31e1676c61262eac361c646d8fc75a847b347495d296c1b864.png" src="_images/fe9cc8503c15fd31e1676c61262eac361c646d8fc75a847b347495d296c1b864.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c769b0c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">DiffusionPDE</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;State after $t=1$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ed814f8bcd1d4681936f1237386b7fb6", "version_major": 2, "version_minor": 0}</script><a class="reference internal image-reference" href="_images/3a3f1652363112f45fa10657ac0bb392f3509d4ca84e3c140b79dd6491bf2703.png"><img alt="_images/3a3f1652363112f45fa10657ac0bb392f3509d4ca84e3c140b79dd6491bf2703.png" src="_images/3a3f1652363112f45fa10657ac0bb392f3509d4ca84e3c140b79dd6491bf2703.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c5c5d580&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">CahnHilliardPDE</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;State after $t=100$&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f822777b05b542bcb71382e49281e403", "version_major": 2, "version_minor": 0}</script><a class="reference internal image-reference" href="_images/36afb048abd4c2b53807294ff2c548749b013bf5e5460c61eab74edb7b05ad74.png"><img alt="_images/36afb048abd4c2b53807294ff2c548749b013bf5e5460c61eab74edb7b05ad74.png" src="_images/36afb048abd4c2b53807294ff2c548749b013bf5e5460c61eab74edb7b05ad74.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c52c4200&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">bc_x_left</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>
<span class="n">bc_x_right</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sin(y)&quot;</span><span class="p">}</span>
<span class="n">bc_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">bc_x_left</span><span class="p">,</span> <span class="n">bc_x_right</span><span class="p">]</span>
<span class="n">bc_y</span> <span class="o">=</span> <span class="s2">&quot;periodic&quot;</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">DiffusionPDE</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">[</span><span class="n">bc_x</span><span class="p">,</span> <span class="n">bc_y</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Diffusion with complex boundary conditions&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d33d0db8db8e4811863be1d3624d8fe0", "version_major": 2, "version_minor": 0}</script><a class="reference internal image-reference" href="_images/63ffba0997a3b90e2ac7544345035645a87a420e53f62c0d41a68160cd223745.png"><img alt="_images/63ffba0997a3b90e2ac7544345035645a87a420e53f62c0d41a68160cd223745.png" src="_images/63ffba0997a3b90e2ac7544345035645a87a420e53f62c0d41a68160cd223745.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c423ea80&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">SphericalSymGrid</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">DiffusionPDE</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Diffusion in spherical coordinates&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5d6168ecfe4143f597ccb1d18676c3ce", "version_major": 2, "version_minor": 0}</script><a class="reference internal image-reference" href="_images/1e68d9ff14e819d17f644b6546fe9c6e533ce0483ef8c7b477bfc6ec7f3d139f.png"><img alt="_images/1e68d9ff14e819d17f644b6546fe9c6e533ce0483ef8c7b477bfc6ec7f3d139f.png" src="_images/1e68d9ff14e819d17f644b6546fe9c6e533ce0483ef8c7b477bfc6ec7f3d139f.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c61c1d00&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="trackers">
<h2><span class="section-number">9.7. </span>Trackers<a class="headerlink" href="#trackers" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">CahnHilliardPDE</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="n">PlotTracker</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5d2feaa0f3ca427d85d6028302a88859", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ScalarField(grid=UnitGrid(shape=(128, 128), periodic=[False, False]), data=[[-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 ...
 [1.0 1.0 0.9 ... 1.0 1.0 1.0]
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trackers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;progress&quot;</span><span class="p">,</span> <span class="n">PrintTracker</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="s2">&quot;0:01&quot;</span><span class="p">)]</span>
<span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="n">trackers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "90cb566c67d04280b1e8fdc0e2ed1fec", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t=0, c=-0.0016±0.29
t=0.01, c=-0.0016±0.245
t=0.05, c=-0.0016±0.177
t=0.94, c=-0.0016±0.11
t=11.61, c=-0.0016±0.438
t=53.6, c=-0.0016±0.711
t=137.61, c=-0.0016±0.786
t=258.02, c=-0.0016±0.823
t=401.66, c=-0.0016±0.846
t=559.31, c=-0.0016±0.864
t=723.88, c=-0.0016±0.877
t=892.53, c=-0.0016±0.888
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ScalarField(grid=UnitGrid(shape=(128, 128), periodic=[False, False]), data=[[-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 ...
 [1.0 1.0 0.9 ... 1.0 1.0 1.0]
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]
 [1.0 1.0 1.0 ... 1.0 1.0 1.0]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">storage</span> <span class="o">=</span> <span class="n">MemoryStorage</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
    <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="n">storage</span><span class="o">.</span><span class="n">tracker</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/50b526c6a9454a49a09a45d2d5f2329a11cf84b8a5aa77a96ca89b822a4d64a2.png"><img alt="_images/50b526c6a9454a49a09a45d2d5f2329a11cf84b8a5aa77a96ca89b822a4d64a2.png" src="_images/50b526c6a9454a49a09a45d2d5f2329a11cf84b8a5aa77a96ca89b822a4d64a2.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bf5a2040&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">storage</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">integral</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">fluctuations</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-26.1, 0.29
-26.1, 0.382
-26.1, 0.592
-26.1, 0.651
-26.1, 0.682
-26.1, 0.704
-26.1, 0.721
-26.1, 0.733
-26.1, 0.744
-26.1, 0.753
-26.1, 0.762
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">storage_write</span> <span class="o">=</span> <span class="n">FileStorage</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;simulation.hdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
    <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="n">storage_write</span><span class="o">.</span><span class="n">tracker</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/50b526c6a9454a49a09a45d2d5f2329a11cf84b8a5aa77a96ca89b822a4d64a2.png"><img alt="_images/50b526c6a9454a49a09a45d2d5f2329a11cf84b8a5aa77a96ca89b822a4d64a2.png" src="_images/50b526c6a9454a49a09a45d2d5f2329a11cf84b8a5aa77a96ca89b822a4d64a2.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bf489b00&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">storage_read</span> <span class="o">=</span> <span class="n">FileStorage</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;simulation.hdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">storage_read</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">integral</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">fluctuations</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-26.1, 0.29
-26.1, 0.382
-26.1, 0.592
-26.1, 0.651
-26.1, 0.682
-26.1, 0.704
-26.1, 0.721
-26.1, 0.733
-26.1, 0.744
-26.1, 0.753
-26.1, 0.762
</pre></div>
</div>
</div>
</div>
</section>
<section id="stochastic">
<h2><span class="section-number">9.8. </span>Stochastic<a class="headerlink" href="#stochastic" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">])</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_harmonic</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">KPZInterfacePDE</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">storage</span> <span class="o">=</span> <span class="n">MemoryStorage</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="n">storage</span><span class="o">.</span><span class="n">tracker</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Final configuration&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/d679bc9083ef40cd7961644af48599d1c4a8fbcab3a3119a66a362f5c7193a8e.png"><img alt="_images/d679bc9083ef40cd7961644af48599d1c4a8fbcab3a3119a66a362f5c7193a8e.png" src="_images/d679bc9083ef40cd7961644af48599d1c4a8fbcab3a3119a66a362f5c7193a8e.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c55c41c0&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="poisson">
<h2><span class="section-number">9.9. </span>Poisson<a class="headerlink" href="#poisson" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">bcs</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sin(y)&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;sin(x)&quot;</span><span class="p">}]</span>

<span class="n">field_zero</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
<span class="n">result_laplace</span> <span class="o">=</span> <span class="n">solve_poisson_equation</span><span class="p">(</span><span class="n">rhs</span><span class="o">=</span><span class="n">field_zero</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="n">bcs</span><span class="p">)</span>
<span class="n">result_laplace</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Solution to Laplace&#39;s equation&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/a335256071e67305a7c5a25b9f04b4c6bfc851f015e34e34c2d9aeb3662eae4d.png"><img alt="_images/a335256071e67305a7c5a25b9f04b4c6bfc851f015e34e34c2d9aeb3662eae4d.png" src="_images/a335256071e67305a7c5a25b9f04b4c6bfc851f015e34e34c2d9aeb3662eae4d.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bfc630c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_one</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">data</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">result_poisson</span> <span class="o">=</span> <span class="n">solve_poisson_equation</span><span class="p">(</span><span class="n">rhs</span><span class="o">=</span><span class="n">field_one</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">})</span>
<span class="n">result_poisson</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/d0acf4720027c6987aac5d4e87ba81098197ad6ee560fc5026eab207a4d54dbc.png"><img alt="_images/d0acf4720027c6987aac5d4e87ba81098197ad6ee560fc5026eab207a4d54dbc.png" src="_images/d0acf4720027c6987aac5d4e87ba81098197ad6ee560fc5026eab207a4d54dbc.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bf9ecd00&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_poisson</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ScalarField(grid=CartesianGrid(bounds=((0.0, 6.283185307179586), (0.0, 6.283185307179586)), shape=(64, 64), periodic=[False, False]), data=[[-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 ...
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]
 [-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="diffusion-equation">
<h2><span class="section-number">9.10. </span>Diffusion equation<a class="headerlink" href="#diffusion-equation" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">PDE</span><span class="p">(</span><span class="n">rhs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="s2">&quot;laplace(u)&quot;</span><span class="p">})</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_normal</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Initial state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">sol</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Final state&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d9eac7b7103a4d7cb4336e7960c888d0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FieldCollection</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">sol</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/00f03dc0b903bc536ac56d96536c14a36bd9497c8f2a878c7485af680857d400.png"><img alt="_images/00f03dc0b903bc536ac56d96536c14a36bd9497c8f2a878c7485af680857d400.png" src="_images/00f03dc0b903bc536ac56d96536c14a36bd9497c8f2a878c7485af680857d400.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;pde.tools.plotting.PlotReference at 0x7f23c4d0efc0&gt;,
 &lt;pde.tools.plotting.PlotReference at 0x7f23c4e0f1c0&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">d0</span><span class="p">,</span> <span class="n">d1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">PDE</span><span class="p">(</span>
    <span class="n">rhs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d0</span><span class="si">}</span><span class="s2"> * laplace(u) + </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> - (</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> + 1) * u + u**2 * v&quot;</span><span class="p">,</span>
        <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d1</span><span class="si">}</span><span class="s2"> * laplace(v) + </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2"> * u - u**2 * v&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Field $u$&quot;</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_normal</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Field $v$&quot;</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">FieldCollection</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="n">PlotTracker</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a8589e494fd249a28c290e7903870475", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">KuramotoSivashinskyPDE</span><span class="p">(</span><span class="n">PDEBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation of the normalized Kuramoto–Sivashinsky equation&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">evolution_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;implement the python version of the evolution equation&quot;&quot;&quot;</span>
        <span class="n">state_lap</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="s2">&quot;natural&quot;</span><span class="p">)</span>
        <span class="n">state_lap2</span> <span class="o">=</span> <span class="n">state_lap</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="s2">&quot;natural&quot;</span><span class="p">)</span>
        <span class="n">state_grad</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="s2">&quot;natural&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">state_grad</span><span class="o">.</span><span class="n">to_scalar</span><span class="p">(</span><span class="s2">&quot;squared_sum&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">state_lap</span> <span class="o">-</span> <span class="n">state_lap2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">KuramotoSivashinskyPDE</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ea6224b8960b47fe92068930ee967c7e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Final state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/74eaae810988946455f15516f423b287b7b8dc848eb0aa3c2ac5689068ac1a23.png"><img alt="_images/74eaae810988946455f15516f423b287b7b8dc848eb0aa3c2ac5689068ac1a23.png" src="_images/74eaae810988946455f15516f423b287b7b8dc848eb0aa3c2ac5689068ac1a23.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c46504c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">DiffusionPDE</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver1</span> <span class="o">=</span> <span class="n">ExplicitSolver</span><span class="p">(</span><span class="n">pde</span><span class="o">=</span><span class="n">eq</span><span class="p">)</span>
<span class="n">controller1</span> <span class="o">=</span> <span class="n">Controller</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">solver1</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">sol1</span> <span class="o">=</span> <span class="n">controller1</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">sol1</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;py-pde&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">controller1</span><span class="o">.</span><span class="n">diagnostics</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;controller&#39;: {&#39;jit_count&#39;: {&#39;make_stepper&#39;: 11, &#39;simulation&#39;: 0},
                &#39;process_count&#39;: 1,
                &#39;profiler&#39;: {&#39;compilation&#39;: 7.091595646999991,
                             &#39;solver&#39;: 0.0371080500000005,
                             &#39;tracker&#39;: 3.969099998357706e-05},
                &#39;solver_duration&#39;: &#39;0:00:00.037145&#39;,
                &#39;solver_start&#39;: &#39;2023-12-24 13:08:30.108362&#39;,
                &#39;stop_reason&#39;: &#39;Reached final time&#39;,
                &#39;successful&#39;: True,
                &#39;t_end&#39;: 1.0,
                &#39;t_final&#39;: 1.0,
                &#39;t_start&#39;: 0},
 &#39;package_version&#39;: &#39;0.33.3&#39;,
 &#39;solver&#39;: {&#39;backend&#39;: &#39;numba&#39;,
            &#39;class&#39;: &#39;ExplicitSolver&#39;,
            &#39;dt&#39;: 0.001,
            &#39;pde_class&#39;: &#39;DiffusionPDE&#39;,
            &#39;scheme&#39;: &#39;euler&#39;,
            &#39;state_modifications&#39;: 0.0,
            &#39;steps&#39;: 1000,
            &#39;stochastic&#39;: False}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver2</span> <span class="o">=</span> <span class="n">ScipySolver</span><span class="p">(</span><span class="n">pde</span><span class="o">=</span><span class="n">eq</span><span class="p">)</span>
<span class="n">controller2</span> <span class="o">=</span> <span class="n">Controller</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">solver2</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tracker</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">sol2</span> <span class="o">=</span> <span class="n">controller2</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">field</span><span class="p">)</span>
<span class="n">sol2</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;scipy&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">controller2</span><span class="o">.</span><span class="n">diagnostics</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;controller&#39;: {&#39;jit_count&#39;: {&#39;make_stepper&#39;: 1, &#39;simulation&#39;: 0},
                &#39;process_count&#39;: 1,
                &#39;profiler&#39;: {&#39;compilation&#39;: 1.4302910570000051,
                             &#39;solver&#39;: 0.002160049999986313,
                             &#39;tracker&#39;: 3.3870000009983414e-05},
                &#39;solver_duration&#39;: &#39;0:00:00.002188&#39;,
                &#39;solver_start&#39;: &#39;2023-12-24 13:08:32.156849&#39;,
                &#39;stop_reason&#39;: &#39;Reached final time&#39;,
                &#39;successful&#39;: True,
                &#39;t_end&#39;: 1.0,
                &#39;t_final&#39;: 1.0,
                &#39;t_start&#39;: 0},
 &#39;package_version&#39;: &#39;0.33.3&#39;,
 &#39;solver&#39;: {&#39;backend&#39;: &#39;numba&#39;,
            &#39;class&#39;: &#39;ScipySolver&#39;,
            &#39;dt&#39;: None,
            &#39;pde_class&#39;: &#39;DiffusionPDE&#39;,
            &#39;steps&#39;: 50,
            &#39;stochastic&#39;: False}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Mean squared deviation: </span><span class="si">{</span><span class="p">((</span><span class="n">sol1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sol2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">average</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">FieldCollection</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">sol1</span><span class="p">,</span> <span class="n">sol2</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/c44b312efc0fbb1ad38a474bcbf285a14bcef15d4d096a3d766743336ec04772.png"><img alt="_images/c44b312efc0fbb1ad38a474bcbf285a14bcef15d4d096a3d766743336ec04772.png" src="_images/c44b312efc0fbb1ad38a474bcbf285a14bcef15d4d096a3d766743336ec04772.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;pde.tools.plotting.PlotReference at 0x7f23c576eec0&gt;,
 &lt;pde.tools.plotting.PlotReference at 0x7f23bf3b76c0&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CylindricalSymGrid</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">bounds_z</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">field</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/86e91e532f191c42cb34e517ce9ff3e00866faebd5f1f3218ccba61136bab9a8.png"><img alt="_images/86e91e532f191c42cb34e517ce9ff3e00866faebd5f1f3218ccba61136bab9a8.png" src="_images/86e91e532f191c42cb34e517ce9ff3e00866faebd5f1f3218ccba61136bab9a8.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c51a6740&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">axes_coords</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">field</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
<span class="n">field</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/fb14c5fe5063cf242570481302ae432187c1f31e57538ba833aab4730b5373e6.png"><img alt="_images/fb14c5fe5063cf242570481302ae432187c1f31e57538ba833aab4730b5373e6.png" src="_images/fb14c5fe5063cf242570481302ae432187c1f31e57538ba833aab4730b5373e6.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c46675c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_normal</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">field</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Average=</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">average</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/9e3497ccfee0964f73da2d9c3e5a85020ea00d0835e23d500fe1587f8044437d.png"><img alt="_images/9e3497ccfee0964f73da2d9c3e5a85020ea00d0835e23d500fe1587f8044437d.png" src="_images/9e3497ccfee0964f73da2d9c3e5a85020ea00d0835e23d500fe1587f8044437d.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bef868c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slice_x</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">})</span>
<span class="n">slice_x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Slice field along line $y=\pi$&quot;</span><span class="p">)</span>

<span class="n">project_x</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">project_x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Projection by integration along $y$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/03f19322d38ba838b63153eca86c212e331d11a28cddd77a6f760425b3b60f17.png"><img alt="_images/03f19322d38ba838b63153eca86c212e331d11a28cddd77a6f760425b3b60f17.png" src="_images/03f19322d38ba838b63153eca86c212e331d11a28cddd77a6f760425b3b60f17.png" style="width: 1754px; height: 931px;" /></a>
<a class="reference internal image-reference" href="_images/8e955829037cce925e52f0fdb3108d9073e6cf1c7e88aee62dfa536fe8e01a67.png"><img alt="_images/8e955829037cce925e52f0fdb3108d9073e6cf1c7e88aee62dfa536fe8e01a67.png" src="_images/8e955829037cce925e52f0fdb3108d9073e6cf1c7e88aee62dfa536fe8e01a67.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bee32c80&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>
<span class="n">field</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Average=</span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">average</span><span class="si">:</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/bbd72c5f158e3748b32746ca0d5750c68f139b29b01e2fb7e8c7b2a29eae4131.png"><img alt="_images/bbd72c5f158e3748b32746ca0d5750c68f139b29b01e2fb7e8c7b2a29eae4131.png" src="_images/bbd72c5f158e3748b32746ca0d5750c68f139b29b01e2fb7e8c7b2a29eae4131.png" style="width: 1754px; height: 931px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_pol</span> <span class="o">=</span> <span class="n">PolarSymGrid</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">scalar_field1</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span>
    <span class="n">grid</span><span class="o">=</span><span class="n">grid_pol</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;r**2&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Increasing&quot;</span>
<span class="p">)</span>
<span class="n">scalar_field2</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span>
    <span class="n">grid</span><span class="o">=</span><span class="n">grid_pol</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;150/r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Decreasing&quot;</span>
<span class="p">)</span>
<span class="n">collection</span> <span class="o">=</span> <span class="n">FieldCollection</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">scalar_field1</span><span class="p">,</span> <span class="n">scalar_field2</span><span class="p">])</span>
<span class="n">collection</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/2240e9658217300aeff7037964ff48e908e91061d5cd555e05c3beb8c82ea8b3.png"><img alt="_images/2240e9658217300aeff7037964ff48e908e91061d5cd555e05c3beb8c82ea8b3.png" src="_images/2240e9658217300aeff7037964ff48e908e91061d5cd555e05c3beb8c82ea8b3.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;pde.tools.plotting.PlotReference at 0x7f23be96f400&gt;,
 &lt;pde.tools.plotting.PlotReference at 0x7f23bf1020c0&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1b5dba1a3e214e9c1c17e7480e985d72e66e73831413ee6aec628f2dc1ac9c6f.png"><img alt="_images/1b5dba1a3e214e9c1c17e7480e985d72e66e73831413ee6aec628f2dc1ac9c6f.png" src="_images/1b5dba1a3e214e9c1c17e7480e985d72e66e73831413ee6aec628f2dc1ac9c6f.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;pde.tools.plotting.PlotReference at 0x7f23beb530c0&gt;,
 &lt;pde.tools.plotting.PlotReference at 0x7f23c43bb0c0&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_sum</span> <span class="o">=</span> <span class="n">collection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">collection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">field_sum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/92fc0e1a92913a9595fdab69bbcc6f5faa6b5711c0d4f83a2d4392e76ee5dbf8.png"><img alt="_images/92fc0e1a92913a9595fdab69bbcc6f5faa6b5711c0d4f83a2d4392e76ee5dbf8.png" src="_images/92fc0e1a92913a9595fdab69bbcc6f5faa6b5711c0d4f83a2d4392e76ee5dbf8.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bead24c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_per</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">field_per</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid_per</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">laplace_per</span> <span class="o">=</span> <span class="n">field_per</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">)</span>
<span class="n">laplace_per</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of periodic field&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/48cab20b3d7a4c9f252093e2f6ed9db8f7a52789697f0d0b3742d8ac8aede62f.png"><img alt="_images/48cab20b3d7a4c9f252093e2f6ed9db8f7a52789697f0d0b3742d8ac8aede62f.png" src="_images/48cab20b3d7a4c9f252093e2f6ed9db8f7a52789697f0d0b3742d8ac8aede62f.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c493b0c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bc_x</span> <span class="o">=</span> <span class="p">({</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">bc_y</span> <span class="o">=</span> <span class="p">({</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">laplace_dir</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">[</span><span class="n">bc_x</span><span class="p">,</span> <span class="n">bc_y</span><span class="p">])</span>
<span class="n">laplace_dir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of field with Dirichlet boundary conditions&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/77151a8bfa46af43a8ad46a9720b92822d422f7eee6f078f04b174274d815262.png"><img alt="_images/77151a8bfa46af43a8ad46a9720b92822d422f7eee6f078f04b174274d815262.png" src="_images/77151a8bfa46af43a8ad46a9720b92822d422f7eee6f078f04b174274d815262.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c461b5c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">laplace_neu</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">laplace_neu</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of field with Neumann boundary conditions&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/df7912c92565364da8f8f64af44013b5091dad2a755fa8b2592f53d1e842b091.png"><img alt="_images/df7912c92565364da8f8f64af44013b5091dad2a755fa8b2592f53d1e842b091.png" src="_images/df7912c92565364da8f8f64af44013b5091dad2a755fa8b2592f53d1e842b091.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c4ea7280&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">laplace_mix</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}])</span>
<span class="n">laplace_mix</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of field with mixed boundary conditions&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/15a282822fc0c50fd0f9f6ed2b0af46fcf9420aefd7c1542ebe05bc4ab1ba7b6.png"><img alt="_images/15a282822fc0c50fd0f9f6ed2b0af46fcf9420aefd7c1542ebe05bc4ab1ba7b6.png" src="_images/15a282822fc0c50fd0f9f6ed2b0af46fcf9420aefd7c1542ebe05bc4ab1ba7b6.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c57ae300&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_mixed</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">field_mixed</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid_mixed</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;sin(x) * cos(y)&quot;</span><span class="p">)</span>

<span class="n">laplace_mixed</span> <span class="o">=</span> <span class="n">field_mixed</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">bc</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}])</span>
<span class="n">laplace_mixed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Laplacian of mixed field&quot;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png"><img alt="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png" src="_images/1eebe1d41c271236ac0ad3829c668dc3a584beafa20c002d477f22caf59ea8b9.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bec7e100&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">PDE</span><span class="p">(</span><span class="n">rhs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="s2">&quot;1 * laplace(f)&quot;</span><span class="p">})</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_normal</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Initial state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/30d2e21cb7dc3706bac5e791f2e33b4b3ef4a1c907662eadb05f74e9b21811ff.png"><img alt="_images/30d2e21cb7dc3706bac5e791f2e33b4b3ef4a1c907662eadb05f74e9b21811ff.png" src="_images/30d2e21cb7dc3706bac5e791f2e33b4b3ef4a1c907662eadb05f74e9b21811ff.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23c4f8b0c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Final state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "21836db7ba464635b280f6de871b8635", "version_major": 2, "version_minor": 0}</script><a class="reference internal image-reference" href="_images/e74d29cb5a9b3022b39416059a63b207c100b7c2278983278ec52ae11561af29.png"><img alt="_images/e74d29cb5a9b3022b39416059a63b207c100b7c2278983278ec52ae11561af29.png" src="_images/e74d29cb5a9b3022b39416059a63b207c100b7c2278983278ec52ae11561af29.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bea59240&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">50</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_expression</span><span class="p">(</span>
    <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;exp(-((x-</span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">)**2 + (y-</span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">)**2)/</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Initial state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/0dc4f81de52fcc6dde14a430ef6a77e63dd3b7af6f2aa4e8f29cb926c6626000.png"><img alt="_images/0dc4f81de52fcc6dde14a430ef6a77e63dd3b7af6f2aa4e8f29cb926c6626000.png" src="_images/0dc4f81de52fcc6dde14a430ef6a77e63dd3b7af6f2aa4e8f29cb926c6626000.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bddaaa80&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Final state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c487838ca1c145dfbcd17c44eb57bab8", "version_major": 2, "version_minor": 0}</script><a class="reference internal image-reference" href="_images/13657068f0a38f117a9fcc60e6fd17e24f679b5ba0ba6688960aa77582970d0f.png"><img alt="_images/13657068f0a38f117a9fcc60e6fd17e24f679b5ba0ba6688960aa77582970d0f.png" src="_images/13657068f0a38f117a9fcc60e6fd17e24f679b5ba0ba6688960aa77582970d0f.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bdb81a80&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bc_x</span> <span class="o">=</span> <span class="p">({</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">bc_y</span> <span class="o">=</span> <span class="p">({</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;derivative&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">eq_dir</span> <span class="o">=</span> <span class="n">PDE</span><span class="p">(</span><span class="n">rhs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="s2">&quot;laplace(f)&quot;</span><span class="p">},</span> <span class="n">bc</span><span class="o">=</span><span class="p">[</span><span class="n">bc_x</span><span class="p">,</span> <span class="n">bc_y</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">UnitGrid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_normal</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Initial state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/cec927d208450576547faaaa26be6adb29e3de1dafcb30994497974c8650b44e.png"><img alt="_images/cec927d208450576547faaaa26be6adb29e3de1dafcb30994497974c8650b44e.png" src="_images/cec927d208450576547faaaa26be6adb29e3de1dafcb30994497974c8650b44e.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bdb130c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">eq_dir</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">t_range</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Final state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7ae8b40aee664a5b91759b41b21f0f82", "version_major": 2, "version_minor": 0}</script><a class="reference internal image-reference" href="_images/ca0d6e6ac704a92dcb36b26d43c97f2504aa27f59d264144244183e78a8d42e8.png"><img alt="_images/ca0d6e6ac704a92dcb36b26d43c97f2504aa27f59d264144244183e78a8d42e8.png" src="_images/ca0d6e6ac704a92dcb36b26d43c97f2504aa27f59d264144244183e78a8d42e8.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bd807540&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slice_x</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">})</span>
<span class="n">slice_x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Slice field along line $y=\pi$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/fba07357515ebd64a30a52acb0c4904720a8ffe7cb8f6b7fa48d1e33ccdb1c8f.png"><img alt="_images/fba07357515ebd64a30a52acb0c4904720a8ffe7cb8f6b7fa48d1e33ccdb1c8f.png" src="_images/fba07357515ebd64a30a52acb0c4904720a8ffe7cb8f6b7fa48d1e33ccdb1c8f.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bd772240&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">project_x</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">project_x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Projection by integration along $y$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/5318280e5311d7d0874f74802b36742e23981615bc870a55355c7820c4f3f053.png"><img alt="_images/5318280e5311d7d0874f74802b36742e23981615bc870a55355c7820c4f3f053.png" src="_images/5318280e5311d7d0874f74802b36742e23981615bc870a55355c7820c4f3f053.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bd5ef2c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;random_field.hdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">field_loaded</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;random_field.hdf&quot;</span><span class="p">)</span>
<span class="n">field_loaded</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/6aa7611539e12f768bdfa02e6de5c206936f1f8c18f2d5d0bd3cf33df2d3cf1a.png"><img alt="_images/6aa7611539e12f768bdfa02e6de5c206936f1f8c18f2d5d0bd3cf33df2d3cf1a.png" src="_images/6aa7611539e12f768bdfa02e6de5c206936f1f8c18f2d5d0bd3cf33df2d3cf1a.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bd669bc0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ETA</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">maxStep</span><span class="p">,</span> <span class="n">startTime</span><span class="p">):</span>
    <span class="n">_ETA</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">total_dt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_ETA</span> <span class="o">=</span> <span class="s2">&quot;Indeterminate&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">startTime</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">seconds</span>
        <span class="n">total_dt</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">step</span> <span class="o">*</span> <span class="n">maxStep</span>
        <span class="n">_ETA</span> <span class="o">=</span> <span class="n">startTime</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">total_dt</span><span class="p">)</span>
        <span class="n">_ETA</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_ETA</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">maxStep</span><span class="p">)</span><span class="si">:</span><span class="s2">&gt;3</span><span class="si">}</span><span class="s2"> % completed. ETA: </span><span class="si">{</span><span class="n">_ETA</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">total_dt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="si">}</span><span class="s2"> seconds remain).&quot;</span>
        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">width</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">(</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">]],</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">resolution</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">]],</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/5c7fe289b9d4e537d7bf0a22413e75f4f5b337b84023ad2f203a2aa86ac6c0d9.png"><img alt="_images/5c7fe289b9d4e537d7bf0a22413e75f4f5b337b84023ad2f203a2aa86ac6c0d9.png" src="_images/5c7fe289b9d4e537d7bf0a22413e75f4f5b337b84023ad2f203a2aa86ac6c0d9.png" style="width: 1754px; height: 931px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">membrane_mask</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">membrane_mask</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">membrane_mask</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/74f0f1b90b6bf479bdd1e3d274bb24aac9b495077e1a0b4435af9edb9982f1aa.png"><img alt="_images/74f0f1b90b6bf479bdd1e3d274bb24aac9b495077e1a0b4435af9edb9982f1aa.png" src="_images/74f0f1b90b6bf479bdd1e3d274bb24aac9b495077e1a0b4435af9edb9982f1aa.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bd3d2900&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make_laplace_x</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">_make_derivative2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">CartesianGrid</span><span class="o">.</span><span class="n">register_operator</span><span class="p">(</span><span class="s2">&quot;laplace_x&quot;</span><span class="p">,</span> <span class="n">make_laplace_x</span><span class="p">)</span>
<span class="n">c_m</span> <span class="o">=</span> <span class="n">ScalarField</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
<span class="n">c_m</span> <span class="o">*=</span> <span class="n">membrane_mask</span>
<span class="n">c_m</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/db7de23c89179c7a9f67066af18544514f4f58d4c263add6713e2823aa306421.png"><img alt="_images/db7de23c89179c7a9f67066af18544514f4f58d4c263add6713e2823aa306421.png" src="_images/db7de23c89179c7a9f67066af18544514f4f58d4c263add6713e2823aa306421.png" style="width: 1754px; height: 931px;" /></a>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pde.tools.plotting.PlotReference at 0x7f23bd4ad680&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># c_m._apply_operator(&quot;laplace_x&quot;, bc=&quot;natural&quot;).plot()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="jax/kernex.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8. </span>kernex</p>
      </div>
    </a>
    <a class="right-next"
       href="findiff.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">10. </span><code class="docutils literal notranslate"><span class="pre">findiff</span></code> tutorial</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grids">9.1. Grids</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fields">9.2. Fields</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#differential-operators">9.3. Differential operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-fields">9.4. Vector Fields</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#field-collections">9.5. Field collections</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-pdes">9.6. Solving PDEs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trackers">9.7. Trackers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic">9.8. Stochastic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#poisson">9.9. Poisson</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-equation">9.10. Diffusion equation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Carlos Aznarán
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright February 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Jun 03, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
    This webpage is distributed under the terms of the
    <a href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License</a>
    which permits use, duplication, adaptation, distribution and
    reproduction in any medium or format, as long as you give appropriate
    credit to the original author(s) and the source, provide a link to the Creative
    Commons license and indicate if changes were made.
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>